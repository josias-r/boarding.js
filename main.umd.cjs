(function(a,c){typeof exports=="object"&&typeof module<"u"?c(exports):typeof define=="function"&&define.amd?define(["exports"],c):(a=typeof globalThis<"u"?globalThis:a||self,c((a.boarding=a.boarding||{},a.boarding.js={})))})(this,function(a){"use strict";var F=Object.defineProperty;var G=(a,c,u)=>c in a?F(a,c,{enumerable:!0,configurable:!0,writable:!0,value:u}):a[c]=u;var l=(a,c,u)=>(G(a,typeof c!="symbol"?c+"":c,u),u);const m="boarding-popover-item",O="boarding-clearfix",P="boarding-btn-group",f="boarding-popover-tip",T="boarding-popover-title",b="boarding-popover-description",x="boarding-popover-footer",B="boarding-close-btn",H="boarding-next-btn",N="boarding-prev-btn",_="boarding-navigation-btns",E="boarding-coutout-svg",w="boarding-disabled",y="boarding-close-only-btn",A=(h="")=>{const t=document.createElement("div");t.id=m,t.className=h;const i=document.createElement("div");i.classList.add(f);const e=document.createElement("div");e.classList.add(T),e.innerText="Popover Title";const o=document.createElement("div");o.classList.add(b),o.innerText="Popover Description";const n=document.createElement("div");n.classList.add(x,O);const s=document.createElement("button");s.classList.add(B),s.innerText="Close";const r=document.createElement("span");r.classList.add(P,_);const p=document.createElement("button");p.classList.add(N),p.innerText="&larr; Previous";const d=document.createElement("button");return d.classList.add(H),d.innerText="Next &rarr;",r.appendChild(p),r.appendChild(d),n.appendChild(s),n.appendChild(r),t.appendChild(i),t.appendChild(e),t.appendChild(o),t.appendChild(n),{popoverWrapper:t,popoverTip:i,popoverTitle:e,popoverDescription:o,popoverFooter:n,popoverPrevBtn:p,popoverNextBtn:d,popoverCloseBtn:s,popoverFooterBtnGroup:r}};function R(h){if(!h||!("nodeType"in h&&h.nodeType===1&&typeof h.nodeName=="string"))throw new Error("Html Element expected")}function v(h){if(!h)throw new Error(`Variable was expected to not be falsy, but isntead was: ${h}`)}function D(h){const t=h.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function C(h,t){!h||D(h)||h.scrollIntoView(t)}function S({hightlightBox:h,padding:t=0}){const i=window.innerWidth,e=window.innerHeight,o=h.x-t,n=h.y-t,s=h.x+h.width+t,r=h.y+h.height+t;return`M${i},0L0,0L0,${e}L${i},${e}L${i},0ZM${s},${n}L${o},${n}L${o},${r}L${s},${r}L${s},${n}Z`}function k({hightlightBox:h,padding:t=0,fillColor:i="rgb(0,0,0)",opacity:e=1,animated:o=!0}){const n=window.innerWidth,s=window.innerHeight,r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.classList.add(E),o&&r.classList.add(`${E}-animated`),r.setAttribute("viewBox",`0 0 ${n} ${s}`),r.setAttribute("xmlSpace","preserve"),r.setAttribute("xmlnsXlink","http://www.w3.org/1999/xlink"),r.setAttribute("version","version"),r.style.fillRule="evenodd",r.style.clipRule="evenodd",r.style.strokeLinejoin="round",r.style.strokeMiterlimit="2",r.style.zIndex="10000",r.style.position="fixed",r.style.top="0",r.style.left="0",r.style.right="0",r.style.bottom="0",r.style.pointerEvents="none";const p=document.createElementNS("http://www.w3.org/2000/svg","path");return p.setAttribute("d",S({hightlightBox:h,padding:t})),p.style.fill=i,p.style.opacity=`${e}`,p.style.pointerEvents="auto",p.style.cursor="pointer",p.style.transition="0.4s ease",r.appendChild(p),r}class I{constructor(t){l(this,"options");l(this,"cutoutSVGElement");l(this,"currentHighlightedElement");l(this,"previouslyHighlightedElement");this.options={opacity:.75,...t}}highlight(t){t.isSame(this.currentHighlightedElement)||(t.onHighlightStarted(),this.currentHighlightedElement&&!this.currentHighlightedElement.isSame(this.previouslyHighlightedElement)&&this.currentHighlightedElement.onDeselected(),this.previouslyHighlightedElement=this.currentHighlightedElement,this.currentHighlightedElement=t,this.updateCutout(t),t.onHighlighted())}clear(t=!1){var i,e,o;this.currentHighlightedElement&&((e=(i=this.options).onReset)==null||e.call(i,this.currentHighlightedElement)),(o=this.currentHighlightedElement)==null||o.onDeselected(),this.currentHighlightedElement=void 0,this.previouslyHighlightedElement=void 0,this.options.animate&&!t?this.unmountCutoutElement():this.unmountCutoutElement()}refresh(){var e;if(!this.currentHighlightedElement)return;v(this.cutoutSVGElement);const t=window.innerWidth,i=window.innerHeight;this.cutoutSVGElement.setAttribute("viewBox",`0 0 ${t} ${i}`),(e=this.currentHighlightedElement.getPopover())==null||e.refresh(),this.updateCutout(this.currentHighlightedElement,!1)}getOverlayElement(){return this.cutoutSVGElement}mountCutoutElement(t){if(this.cutoutSVGElement)throw new Error("Already mounted SVG");const i=k(t);this.cutoutSVGElement=i,document.body.appendChild(i)}unmountCutoutElement(){if(!this.cutoutSVGElement)throw new Error("No SVG found to unmount");document.body.removeChild(this.cutoutSVGElement),this.cutoutSVGElement=void 0}updateCutout(t,i=this.options.animate){this.currentHighlightedElement=t;const e=t.getElement().getBoundingClientRect(),o={hightlightBox:{x:e.x,y:e.y,width:e.width,height:e.height},padding:this.options.padding,opacity:this.options.opacity,animated:this.options.animate};if(!this.cutoutSVGElement)this.mountCutoutElement(o);else{const n=this.cutoutSVGElement.firstElementChild;if((n==null?void 0:n.tagName)==="path"){const s=n.style.transition;i||(n.style.transition="none"),n.setAttribute("d",S(o)),i||setTimeout(()=>{n.style.transition=s},0)}else throw new Error("No existing path found on SVG but we want one :(")}}}const L=["top","bottom","left","right"];class V{constructor(t,i,e,o){l(this,"highlightElement");l(this,"popover");l(this,"padding");l(this,"finalOffset");this.highlightElement=t,this.popover=i,this.padding=e,this.finalOffset=e+o}setBestPosition(t,i){var n;const e=this.findOptimalPosition(t,i),o=(n=this.popover.getPopoverElements())==null?void 0:n.popoverWrapper;v(o),o.style.left=typeof e.left=="number"?`${e.left}px`:"auto",o.style.right=typeof e.right=="number"?`${e.right}px`:"auto",o.style.top=typeof e.top=="number"?`${e.top}px`:"auto",o.style.bottom=typeof e.bottom=="number"?`${e.bottom}px`:"auto"}getHighlightElemRect(){return this.highlightElement.getBoundingClientRect()}getPopoverDimensions(){var i;const t=(i=this.popover.getPopoverElements())==null?void 0:i.popoverWrapper.getBoundingClientRect();return v(t),{width:t.width+this.finalOffset,height:t.height+this.finalOffset}}checkIfSideOptimal(t){const i=this.getPopoverDimensions(),e=this.getHighlightElemRect();switch(t){case"top":const o=e.top-i.height;return{side:"top",value:o,isOptimal:o>=0};case"bottom":const n=window.innerHeight-(e.bottom+i.height);return{side:"bottom",value:n,isOptimal:n>=0};case"left":const s=e.left-i.width;return{side:"left",value:s,isOptimal:s>=0};case"right":const r=window.innerWidth-(e.right+i.width);return{side:"right",value:r,isOptimal:r>=0}}}findOptimalSide(t=0){const i=L[t],e=this.checkIfSideOptimal(i);return e.isOptimal?e:t===L.length-1?"none":this.findOptimalSide(t+1)}normalizeAlignment(t,i,e,o,n){switch(t){case"start":return Math.min(e-this.padding,o-i);case"end":return Math.min(e-i+n+this.padding,o-i);case"center":const s=e-i/2+n/2,r=Math.min(s,o-i),p=Math.min(s,o);return p!==s?p:r!==s?r:Math.max(0,s)}}findOptimalPosition(t,i){let e;if(i?(e=this.checkIfSideOptimal(i),e.isOptimal||(e=this.findOptimalSide())):e=this.findOptimalSide(),e==="none"){const o=this.getPopoverDimensions();return{left:window.innerWidth/2-(o.width-this.finalOffset)/2,top:window.innerHeight/2-(o.height-this.finalOffset)/2}}else{const o=this.getPopoverDimensions(),n=this.getHighlightElemRect(),s={};switch(e.side){case"top":s.top=e.value,s.left=this.normalizeAlignment(t,o.width-this.finalOffset,n.left,window.innerWidth,n.width);break;case"bottom":console.log(o.width-this.finalOffset),s.bottom=e.value,s.left=this.normalizeAlignment(t,o.width-this.finalOffset,n.left,window.innerWidth,n.width);break;case"left":s.left=e.value,s.top=this.normalizeAlignment(t,o.height-this.finalOffset,n.top,window.innerHeight,n.height);break;case"right":s.right=e.value,s.top=this.normalizeAlignment(t,o.height-this.finalOffset,n.top,window.innerHeight,n.height);break}return this.setPopoverTipPosition(e.side,t),s}}setPopoverTipPosition(t,i){var o;const e=(o=this.popover.getPopoverElements())==null?void 0:o.popoverTip;v(e),e.className=f,e.classList.add(`boarding-tipside-${t}`,`boarding-tipalign-${i}`)}}class M{constructor({showButtons:t=!0,offset:i=10,alignment:e="start",closeBtnText:o="Close",doneBtnText:n="Done",startBtnText:s="Next &rarr;",nextBtnText:r="Next &rarr;",prevBtnText:p="&larr; Previous",...d}){l(this,"options");l(this,"popover");l(this,"highlightElement");this.options={showButtons:t,offset:i,alignment:e,closeBtnText:o,doneBtnText:n,startBtnText:s,nextBtnText:r,prevBtnText:p,...d}}hide(){!this.popover||(this.highlightElement=void 0,this.popover.popoverWrapper.style.display="none")}show(t){this.highlightElement=t,this.attachNode(),v(this.popover),v(this.highlightElement),this.setInitialState(),this.popover.popoverTitle.innerHTML=this.options.title||"",this.popover.popoverDescription.innerHTML=this.options.description||"",this.renderFooter(),this.setPosition(),C(this.popover.popoverWrapper,this.options.scrollIntoViewOptions)}refresh(){!this.highlightElement||this.setPosition()}getPopoverElements(){return this.popover}getShowButtons(){return this.options.showButtons}setInitialState(){v(this.popover),this.popover.popoverWrapper.style.display="block",this.popover.popoverWrapper.style.left="0",this.popover.popoverWrapper.style.top="0",this.popover.popoverWrapper.style.bottom="",this.popover.popoverWrapper.style.right=""}setPosition(){v(this.highlightElement),new V(this.highlightElement.getElement(),this,this.options.padding,this.options.offset).setBestPosition(this.options.alignment,this.options.prefferedSide)}attachNode(){var d;this.popover&&((d=this.popover.popoverWrapper.parentElement)==null||d.removeChild(this.popover.popoverWrapper));const{popoverWrapper:t,popoverTip:i,popoverTitle:e,popoverDescription:o,popoverFooter:n,popoverPrevBtn:s,popoverNextBtn:r,popoverCloseBtn:p}=A(this.options.className);this.options.animate&&t.classList.add(`${m}-animated`),document.body.appendChild(t),this.popover={popoverWrapper:t,popoverTip:i,popoverTitle:e,popoverDescription:o,popoverFooter:n,popoverPrevBtn:s,popoverNextBtn:r,popoverCloseBtn:p}}renderFooter(){v(this.popover),this.popover.popoverNextBtn.innerHTML=this.options.nextBtnText,this.popover.popoverPrevBtn.innerHTML=this.options.prevBtnText,this.popover.popoverCloseBtn.innerHTML=this.options.closeBtnText;const t=this.options.totalCount&&this.options.totalCount!==1;if(!this.options.showButtons){this.popover.popoverFooter.style.display="none";return}t?(this.popover.popoverNextBtn.style.display="inline-block",this.popover.popoverPrevBtn.style.display="inline-block",this.popover.popoverCloseBtn.classList.remove(y)):(this.popover.popoverNextBtn.style.display="none",this.popover.popoverPrevBtn.style.display="none",this.popover.popoverCloseBtn.classList.add(y)),this.popover.popoverFooter.style.display="block",this.options.isFirst?(this.popover.popoverPrevBtn.classList.add(w),this.popover.popoverNextBtn.innerHTML=this.options.startBtnText):this.popover.popoverPrevBtn.classList.remove(w),this.options.isLast?this.popover.popoverNextBtn.innerHTML=this.options.doneBtnText:this.popover.popoverNextBtn.innerHTML=this.options.nextBtnText}}class ${constructor({options:t,highlightDomElement:i,popover:e}){l(this,"options");l(this,"highlightDomElement");l(this,"popover");this.highlightDomElement=i,this.options=t,this.popover=e}isSame(t){return!t||!t.highlightDomElement?!1:t.highlightDomElement===this.highlightDomElement}getElement(){return this.highlightDomElement}getPopover(){return this.popover}onDeselected(){var t,i,e;(t=this.popover)==null||t.hide(),(e=(i=this.options).onDeselected)==null||e.call(i,this)}onHighlightStarted(){var t,i;(i=(t=this.options).onHighlightStarted)==null||i.call(t,this)}onHighlighted(){var t,i,e;C(this.highlightDomElement,this.options.scrollIntoViewOptions),(t=this.popover)==null||t.show(this),(e=(i=this.options).onHighlighted)==null||e.call(i,this)}onNext(){var t,i;(i=(t=this.options).onNext)==null||i.call(t,this)}onPrevious(){var t,i;(i=(t=this.options).onPrevious)==null||i.call(t,this)}}class W{constructor(t){l(this,"isActivated");l(this,"options");l(this,"steps");l(this,"currentStep");l(this,"currentMovePrevented");l(this,"overlay");const{strictClickHandling:i=!0,animate:e=!0,opacity:o=.75,padding:n=10,scrollIntoViewOptions:s={behavior:"auto",block:"center"},allowClose:r=!0,keyboardControl:p=!0,overlayClickNext:d=!1,...g}={...t};this.options={strictClickHandling:i,animate:e,opacity:o,padding:n,scrollIntoViewOptions:s,allowClose:r,keyboardControl:p,overlayClickNext:d,...g},this.isActivated=!1,this.steps=[],this.currentStep=0,this.currentMovePrevented=!1,this.overlay=new I({animate:this.options.animate,padding:this.options.padding,onReset:this.options.onReset}),this.onResize=this.onResize.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onClick=this.onClick.bind(this),this.moveNext=this.moveNext.bind(this),this.movePrevious=this.movePrevious.bind(this),this.preventMove=this.preventMove.bind(this)}start(t=0){if(!this.steps||this.steps.length===0)throw new Error("There are no steps defined to iterate");this.attachEventListeners(),this.isActivated=!0,this.currentStep=t,this.overlay.highlight(this.steps[t])}highlight(t){const i=typeof t=="object"&&"element"in t?t:{element:t},e=this.prepareElementFromStep(i);!e||(this.attachEventListeners(),this.isActivated=!0,this.overlay.highlight(e))}refresh(){this.overlay.refresh()}movePrevious(){const t=this.steps[this.currentStep-1];if(!t){this.reset();return}this.overlay.highlight(t),this.currentStep-=1}preventMove(){this.currentMovePrevented=!0}moveNext(){const t=this.steps[this.currentStep+1];if(!t){this.reset();return}this.overlay.highlight(t),this.currentStep+=1}hasNextStep(){return!!this.steps[this.currentStep+1]}hasPreviousStep(){return!!this.steps[this.currentStep-1]}reset(t=!1){this.currentStep=0,this.isActivated=!1,this.overlay.clear(t),this.removeEventListeners()}hasHighlightedElement(){return!!this.overlay.currentHighlightedElement}getHighlightedElement(){return this.overlay.currentHighlightedElement}getLastHighlightedElement(){return this.overlay.previouslyHighlightedElement}defineSteps(t){this.steps=[];for(let i=0;i<t.length;i++){const e=this.prepareElementFromStep(t[i],t,i);!e||this.steps.push(e)}}getSteps(){return this.steps}setSteps(t){this.steps=t}attachEventListeners(){window.addEventListener("resize",this.onResize,!1),window.addEventListener("scroll",this.onResize,!1),window.addEventListener("keyup",this.onKeyUp,!1),"ontouchstart"in document.documentElement?window.addEventListener("touchstart",this.onClick,!1):window.addEventListener("click",this.onClick,!1)}removeEventListeners(){window.removeEventListener("resize",this.onResize,!1),window.removeEventListener("scroll",this.onResize,!1),window.removeEventListener("keyup",this.onKeyUp,!1),window.removeEventListener("click",this.onClick,!1),window.removeEventListener("touchstart",this.onClick,!1)}onClick(t){var p,d;if(!this.overlay.currentHighlightedElement)return;R(t.target);const i=this.overlay.currentHighlightedElement,e=i.getElement().contains(t.target),o=(p=i.getPopover())==null?void 0:p.getPopoverElements(),n=o==null?void 0:o.popoverWrapper.contains(t.target),s=(d=this.overlay.getOverlayElement())==null?void 0:d.contains(t.target),r=!n&&!s&&!e;if(this.options.strictClickHandling&&r){t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation();return}if(s&&this.options.overlayClickNext){this.handleNext();return}if(s&&this.options.allowClose){this.reset();return}if(o){const g=t.target.contains(o.popoverNextBtn),U=t.target.contains(o.popoverPrevBtn);if(t.target.contains(o.popoverCloseBtn)){this.reset();return}g?this.handleNext():U&&this.handlePrevious()}}onResize(){!this.isActivated||this.refresh()}onKeyUp(t){var e;if(!this.isActivated||!this.options.keyboardControl)return;if(t.key==="Escape"&&this.options.allowClose){this.reset();return}const i=this.getHighlightedElement();!i||!i.getPopover()||!((e=i.getPopover())!=null&&e.getShowButtons())||(t.key==="ArrowRight"?this.handleNext():t.key==="ArrowLeft"&&this.handlePrevious())}handleNext(){this.currentMovePrevented=!1;const t=this.steps[this.currentStep];t==null||t.onNext(),!this.currentMovePrevented&&this.moveNext()}handlePrevious(){this.currentMovePrevented=!1;const t=this.steps[this.currentStep];t==null||t.onPrevious(),!this.currentMovePrevented&&this.movePrevious()}prepareElementFromStep(t,i=[],e=0){var s;const o=typeof t.element=="string"?document.querySelector(t.element):t.element;if(!o)return console.warn(`Element to highlight ${t.element} not found`),null;let n=null;if((s=t.popover)!=null&&s.title){const r=[this.options.className,t.popover.className].filter(p=>p).join(" ");n=new M({padding:this.options.padding,offset:this.options.offset,animate:this.options.animate,scrollIntoViewOptions:this.options.scrollIntoViewOptions,title:t.popover.title,description:t.popover.description,prefferedSide:t.popover.prefferedSide||this.options.prefferedSide,alignment:t.popover.alignment||this.options.alignment,showButtons:t.popover.showButtons||this.options.showButtons,doneBtnText:t.popover.doneBtnText||this.options.doneBtnText,closeBtnText:t.popover.closeBtnText||this.options.closeBtnText,nextBtnText:t.popover.nextBtnText||this.options.nextBtnText,startBtnText:t.popover.startBtnText||this.options.startBtnText,prevBtnText:t.popover.prevBtnText||this.options.prevBtnText,className:r,totalCount:i.length,currentIndex:e,isFirst:e===0,isLast:i.length===0||e===i.length-1})}return new $({highlightDomElement:o,options:{scrollIntoViewOptions:this.options.scrollIntoViewOptions,onHighlightStarted:this.options.onHighlightStarted,onHighlighted:this.options.onHighlighted,onDeselected:this.options.onDeselected,onNext:t.onNext,onPrevious:t.onPrevious},popover:n})}}a.Boarding=W,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
